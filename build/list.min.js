!function(a,b,c){"use strict";angular.module("ambersive.list",["ui.router","ambersive.routerui.auth"]),angular.module("ambersive.list").provider("$datalistSettings",[function(){var a={langChooseAll:"Choose all",langRefresh:"Refresh",langPleaseWait:"Please wait",langBtnNext:"Next",langBtnPrevious:"Previous",langTextNoPermission:"You do not have enough permission to see this data.",langTextNotLogged:"Please login to see this data",langSearchBtn:"Search",langSearchPlaceholder:"Searchterm",langNoEntries:"No entries avaiable",langErrorData:"Data could not be loaded.",template:"src/views/ambersive.list.default.html",entriesPerPage:10};return{setValue:function(b,d){a[b]!==c&&(a[b]=d)},$get:function(){return{all:a,template:a.template,langChooseAll:a.langChooseAll,langRefresh:a.langRefresh,langPleaseWait:a.langPleaseWait,langBtnPrevious:a.langBtnPrevious,langBtnNext:a.langBtnNext,langTextNoPermission:a.langTextNoPermission,langTextNotLogged:a.langTextNotLogged,langSearchBtn:a.langSearchBtn,langSearchPlaceholder:a.langSearchPlaceholder,langNoEntries:a.langNoEntries,langErrorData:a.langErrorData,entriesPerPage:a.entriesPerPage}}}}]),angular.module("ambersive.list").config(["$urlRouterProvider",function(a){}]),angular.module("ambersive.list").run(["$rootScope","$state","$log",function(a,b,c){}]),angular.module("ambersive.list").factory("DatalistSrv",["$q","$log","$state","$rootScope",function(a,b,d,e){var f={},g={};return f.isAuthenticated=!1,f.checkPermission=function(a){var b=!0,d=!1,e=function(){if(a.permission!==c&&a.permission.roles!==c){var e=a.permission.roles;if(angular.isArray(e)&&e.length>0&&(d=!0),angular.isArray(e)&&f.isAuthenticated===!1&&d===!0||g.roles===c&&d===!0)return!1;if(b=g.roles.some(function(a){return e.indexOf(a)>-1}),d===!0&&b===!1)return!1}return!0};return e()},e.$on("$stateAuthenticationUser",function(a,b){return g=b.user,b.user.roles!==c&&f.isAuthenticated===!1?void(f.isAuthenticated=!0):void(f.isAuthenticated=!1)}),f}]),angular.module("ambersive.list").directive("datalist",["$compile",function(a){var b={};return b.restrict="E",b.scope={template:"@",subTemplate:"@",searchTemplate:"@",rest:"=",api:"@",apiMethod:"@",settings:"=",simple:"@",id:"@"},b.replace=!0,b.transclude=!0,b.controller=["$compile","$scope","$rootScope","$state","$element","$log","$timeout","$templateCache","$http","$q","$datalistSettings","DB","DatalistSrv",function(a,b,d,e,f,g,h,i,j,k,l,m,n){var o=this,p={};b.datalist=o,o.getTemplateByUrl=!1,o.data=[],o.result={},o.loading=!0,o.errorOccured=!1,o.errorMessage="",o.actionLoading=!1,o.selectedItems=[],o.allSelected=!1,o.actionItems=[],o.langChooseAll=l.langChooseAll,o.langRefresh=l.langRefresh,o.langPleaseWait=l.langPleaseWait,o.langBtnPrevious=l.langBtnPrevious,o.langBtnNext=l.langBtnNext,o.entriesPerPage=l.entriesPerPage,o.langTextNoPermission=l.langTextNoPermission,o.langTextNotLogged=l.langTextNotLogged,o.langSearchBtn=l.langSearchBtn,o.langSearchPlaceholder=l.langSearchPlaceholder,o.langNoEntries=l.langNoEntries,o.currentPage=0,o.authenticated=n.isAuthenticated,o.accessGranted=!0,o.searchTerm="",b.template!==c?o.templateUrl=b.template:o.templateUrl=l.template,b.subTemplate!==c&&(o.subTemplate=b.subTemplate),b.settings!==c&&(p=b.settings),b.rest!==c&&(o.rest=b.rest),b.api!==c&&(o.api=b.api),b.apiMethod!==c?o.apiMethod=b.apiMethod:o.apiMethod="get",o.simple="true"===b.simple&&b.simple!==c,p.search===c&&(p.search=!1),p.pagination===c&&(p.pagination=!0),b.$watch("datalist.currentPage",function(){if(angular.isArray(o.result)&&o.result.length===o.total)if(p.pagination===!0){var a=o.entriesPerPage*o.currentPage-o.entriesPerPage,c=o.entriesPerPage,d=angular.copy(o.result);h(function(){o.data=d.splice(a,c),b.$apply()})}else h(function(){o.data=angular.copy(o.result),b.$apply()});else angular.isObject(o.result)&&o.getData(o.currentPage)}),b.warn=function(a){g.warn(a)},o.checkActionForMultiple=function(a){if(a.multiple!==c)if(angular.isObject(a.multiple)){var b=a.multiple.show||!1;a.multiple.only||!1;if(b===!0)return a;if(b===!1&&o.selectedItems.length>0)return a}else{var d=a.multiple||!1;if(d===!0&&o.selectedItems.length>0)return a}},o.checkActionForSingle=function(a){if(n.checkPermission(a)!==!1){var b=!1;return a.multiple!==c&&angular.isObject(a.multiple)&&(b=a.multiple.only||!1),b===!1?a:void 0}},o.getMenu=function(){p.actions!==c&&(o.actions=angular.copy(p.actions).filter(o.checkActionForSingle),o.actionsMultiple=angular.copy(p.actions).filter(o.checkActionForMultiple))},o.rowDisabled=function(a){return o.actionLoading===!0&&(o.selectedItems.indexOf(a)>-1||o.actionItems.indexOf(a)>-1)?!0:!1},o.controlFilter=function(a){var b=!1;return p.controlFilter===c?!0:(b=p.controlFilter(a),b===c&&(b=!0),b)},o.startSearch=function(){o.getData(null,o.searchTerm)},o.init=function(){var d=null;o.getMenu(),d=i.get(o.templateUrl),d===c&&o.templateUrl!==c&&(b.getTemplateByUrl=!0,o.getData(),j.get(o.templateUrl,{}).then(function(c){200===c.status?(d=c.data,f.html(d),f.replaceWith(a(f.html())(b))):b.warn("ambersive.list: $http loading template failed")},function(){b.warn("aambersive.list: $http loading template failed")})),b.templateHtml=d},o.getData=function(a,d){var f=k.defer(),i={},q={},r="",s=function(d){var e=d;d.data!==c&&(e=d.data),o.currentPage=a,angular.isArray(e)?(o.result=e,d.total!==c?o.total=d.total:o.total=e.length,o.loading=!1,h(function(){b.$apply()},0)):angular.isObject(e)&&(o.total=e.length,angular.isDefined(d.per_page)===!0&&(o.entriesPerPage=parseInt(d.per_page)),d.total!==c&&(o.total=e.total),e.entries!==c?o.result=e.entries:o.result=e,h(function(){b.$apply()},0),o.loading=!1),f.resolve()};return(a===c||0===a||null===a)&&(a=1),o.accessGranted=n.checkPermission(p),o.authenticated=n.isAuthenticated,o.accessGranted===!1?void(o.loading=!1):(o.loading=!0,o.errorOccured=!1,o.api!==c?(i=m(o.api),q=e.params,q.page=a,d!==c&&""!==d?q.search=d:delete q.search,i.$has(o.apiMethod).then(function(a){a===!0?i[o.apiMethod](q).then(function(a){s(a),o.data=o.result,f.resolve()},function(a){o.data=[],o.errorOccured=!0,null!==a&&a.message!==c?o.errorMessage=a.message:o.errorMessage=l.langErrorData,f.reject(a)}):(o.data=[],o.errorOccured=!0,o.errorMessage=l.langErrorData,f.reject({}))})):o.rest!==c?(r="",d!==c&&""!==d&&(r="?search="+d),angular.isString(o.rest)?j.get(o.rest+r,{}).then(function(a){s(a.data)},function(a){g.warn("aambersive.list: $http get error (rest)"),f.resolve()}):angular.isObject(o.rest)&&j(o.rest+r).then(function(a){s(a.data)},function(a){g.warn("aambersive.list: $http get error (rest)"),f.resolve()})):f.resolve(),f.promise)},o.refresh=function(a){a!==c&&a.preventDefault(),o.selectedItems=[],o.actionLoading!==!0&&(o.getData(o.currentPage),o.getMenu())},o.callAction=function(a,b,d,e){e===c&&(e=[b.id]),d!==c&&d.preventDefault();var g,h={},i=function(a){var b=o.actionItems.indexOf(a);b>-1&&o.actionItems.splice(b,1),o.actionLoading=!1};o.actionLoading=!0,o.actionItems.push(b.id),a.apiMethod!==c?(h=m(o.api),g=function(){h[a.apiMethod](b.id,b).then(function(d,e){e===c&&(e=!0),a.successFn!==c&&angular.isFunction(a.successFn)&&a.successFn(d,f),e===!0&&o.getData(o.currentPage),i(b.id)},function(d){a.errorFn!==c&&angular.isFunction(a.errorFn)&&a.errorFn(d,f),i(b.id)})},a.preFn!==c?a.preFn(e).then(function(a){g()},function(a){i(b.id)}):g()):a.fn!==c&&(g=function(){a.fn(b.id,b).then(function(d){d!==c&&d.refresh===c&&(d.refresh=!0),a.successFn!==c&&angular.isFunction(a.successFn)&&a.successFn(d.result,f),d!==c&&d.refresh===!0&&o.getData(o.currentPage),i(b.id)},function(d){a.errorFn!==c&&angular.isFunction(a.errorFn)&&a.errorFn(d,f),d.refresh===c&&(d.refresh=!0),d!==c&&d.refresh===!0&&o.getData(o.currentPage),i(b.id)})},a.preFn!==c?a.preFn(e).then(function(a){g()},function(a){i(b.id)}):g())},o.callActionMultiple=function(a,b,d){if(d!==c&&d.preventDefault(),o.actionLoading!==!0){o.actionLoading=!0;var e,f={},g=null,h=0,i=function(a,d,e){return d===c&&(d=!1),d===!0?void(o.actionLoading=!1):(h++,void(h===b.length&&(o.actionLoading=!1,e===!0&&o.refresh())))},j=!1;a.apiMethod!==c?(f=m(o.api),g=function(b){f[a.apiMethod](b).then(function(b,c){i(b,j,a.refresh)},function(b){i(b,j,a.refresh)})},e=function(){a.multiple!==c&&a.multiple.single===!0?(j=!0,g(0)):b.forEach(function(b,c){f[a.apiMethod](b).then(function(b,c){i(b,!1,a.refresh)},function(b){i(b,!1,a.refresh)})})},a.preFn!==c?a.preFn(b).then(function(a){e()},function(a){o.actionItems=[],o.actionLoading=!1}):e()):a.fn!==c&&(g=function(b){a.fn(b).then(function(b,c){i(b,j,a.refresh)},function(b){i(b,j,a.refresh)})},e=function(){a.multiple!==c&&a.multiple.single===!0?(j=!0,g(0)):b.forEach(function(a,b){g(a)})},a.preFn!==c?a.preFn(b).then(function(a){e()},function(a){o.actionItems=[],o.actionLoading=!1}):e())}},o.toggleItem=function(a,b){var c=o.selectedItems.indexOf(b.id);b.isSelected===!0&&-1===c?o.selectedItems.push(b.id):o.selectedItems.splice(c,1),o.data.length===o.selectedItems.length?o.allSelected=!0:o.allSelected=!1,o.getMenu()},o.selectAll=function(a){o.selectedItems=[];var b=function(a){var b=o.selectedItems.indexOf(a.id);a.isSelected=o.allSelected,a.isSelected===!0&&-1===b?o.selectedItems.push(a.id):o.selectedItems.splice(b,1)};o.data.filter(b),o.getMenu()},o.init(),b.$watch("datalist.singleSelected",function(a){d.$broadcast("$datalistSelectedValue",{value:a})}),b.$on("$stateAuthenticationUser",function(a,b){o.getMenu(),o.getData()}),b.$on("$updateLists",function(a,b){o.getMenu(),o.getData()}),b.$on("$updateListsSingle",function(a,c){c.id===b.id&&(o.getMenu(),o.getData())})}],b.link=function(b,d,e){try{if(b.getTemplateByUrl===!0)return;if(b.templateHtml===c)return void b.warn("ambersive.list: template is undefined");b.datalist.getData(),d.html(b.templateHtml),d.replaceWith(a(d.html())(b))}catch(f){b.warn(f)}},b}])}(window,document,void 0),angular.module("ambersive.list").run(["$templateCache",function(a){"use strict";a.put("src/views/ambersive.list.default.html",'<script type=text/ng-template id=datalistElement.html><div class="row">\n        <div class="col-xs-10">\n            <div class="radiobox" ng-if="settings.radio === true">\n                <label>\n                    <input type="radio" ng-model="datalist.singleSelected" value="{{row.id}}"  ng-disabled="datalist.rowDisabled(row.id)" ng-if="datalist.controlFilter(row)">\n                    <div ng-if="datalist.subTemplate === undefined">{{row.title}}</div>\n                    <div ng-if="datalist.subTemplate !== undefined" ng-include="datalist.subTemplate"></div>\n                </label>\n            </div>\n            <div class="checkbox" ng-if="datalist.actions.length > 0 && settings.radio !== true">\n                <label>\n                    <input type="checkbox" ng-model="row.isSelected" ng-click="datalist.toggleItem($event,row)" ng-disabled="datalist.rowDisabled(row.id)" ng-if="datalist.controlFilter(row)">\n                    <div ng-if="datalist.subTemplate === undefined">{{row.title}}</div>\n                    <div ng-if="datalist.subTemplate !== undefined" ng-include="datalist.subTemplate"></div>\n                </label>\n            </div>\n            <div ng-if="(datalist.actions.length === 0 || datalist.actions === undefined) && datalist.subTemplate === undefined && settings.radio !== true">\n                {{row.title}}\n            </div>\n            <div ng-if="(datalist.actions.length === 0 || datalist.actions === undefined) && datalist.subTemplate !== undefined  && settings.radio !== true" ng-include="datalist.subTemplate"></div>\n        </div>\n        <div class="col-xs-2">\n            <div class="pull-right" ng-if="datalist.actions.length > 0">\n                <div class="item dropdown" uib-dropdown>\n                    <a href="#" class="btn btn-link dropdown-toggle" uib-dropdown-toggle>\n                        <i class="fa fa-chevron-down" ng-if="datalist.rowDisabled(row.id) === false || data.actionLoading === false"></i>\n                        <i ng-include="\'datalistElementLoadingIcon.html\'" ng-if="datalist.rowDisabled(row.id) === true || data.actionLoading === true"></i>\n                    </a>\n                    <ul class="dropdown-menu dropdown-menu-right">\n                        <li ng-repeat="action in datalist.actions" ng-disabled="datalist.actionLoading"><a ng-click="datalist.callAction(action,row,event)"><i ng-if="action.icon" class="{{action.icon}}"></i> {{action.label}}</a></li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div></script><script type=text/ng-template id=datalistElementEmpty.html><div class="row">\n        <div class="col-xs-12">\n            {{datalist.langNoEntries}}\n        </div>\n    </div></script><script type=text/ng-template id=datalistElementError.html><div class="row">\n        <div class="col-xs-12">\n            {{datalist.errorMessage}}\n        </div>\n    </div></script><script type=text/ng-template id=datalistElementLoadingIcon.html><div class="loader loader--style3" title="2">\n        <svg width="20" height="20" version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">\n          <path fill="#000" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">\n            <animateTransform attributeType="xml"\n              attributeName="transform"\n              type="rotate"\n              from="0 25 25"\n              to="360 25 25"\n              dur="0.6s"\n              repeatCount="indefinite"/>\n            </path>\n          </svg>\n    </div></script><div class=datalist_container><div class="row search-container" ng-if="settings.search === true"><div class=col-xs-12><form class=form-inline role=search ng-submit=datalist.startSearch()><div class=form-group><input ng-model=datalist.searchTerm class=form-control placeholder={{datalist.langSearchPlaceholder}}></div><button type=submit class="btn btn-default">{{datalist.langSearchBtn}}</button></form></div></div><div class="panel panel-default" ng-if="datalist.simple === false"><div class=panel-heading><div class=row ng-if="settings.headline !== undefined || settings.description !== undefined"><div class=col-xs-12><strong ng-if=settings.headline>{{settings.headline}}</strong><p ng-if=settings.description>{{settings.description}}</p></div></div><div class=row><div class=col-xs-10><div class=checkbox ng-if="datalist.actions.length > 0 && settings.radio !== true"><label><input type=checkbox ng-model=datalist.allSelected ng-click=datalist.selectAll($event) ng-disabled="loading || datalist.actionLoading"> <span translate>{{datalist.langChooseAll}}</span></label></div></div><div class=col-xs-2><div class="item dropdown pull-right" uib-dropdown><i class="btn btn-link" ng-include="\'datalistElementLoadingIcon.html\'" ng-if="datalist.actionLoading === true"></i> <a href=# class="btn btn-link dropdown-toggle" ng-if="datalist.actionLoading !== true" uib-dropdown-toggle><i class="fa fa-chevron-down"></i></a><ul class="dropdown-menu dropdown-menu-right"><li ng-disabled=datalist.actionLoading><a ng-click=datalist.refresh($event) ng-disabled=datalist.actionLoading><i class="fa fa-refresh"></i> <span translate>{{datalist.langRefresh}}</span></a></li><li ng-repeat="action in datalist.actionsMultiple" ng-disabled=datalist.actionLoading><a ng-click=datalist.callActionMultiple(action,datalist.selectedItems,event) ng-disabled=datalist.actionLoading><i ng-if=action.icon class={{action.icon}}></i> {{action.label}}</a></li></ul></div></div></div></div><ul class=list-group><li class=list-group-item ng-if="datalist.errorOccured === false && datalist.accessGranted === false && datalist.authenticated === false">{{datalist.langTextNotLogged}}</li><li class=list-group-item ng-if="datalist.errorOccured === false && datalist.accessGranted === false && datalist.authenticated === true">{{datalist.langTextNoPermission}}</li><li class=list-group-item ng-if="datalist.errorOccured === false && datalist.loading === false && datalist.accessGranted === true && datalist.data.length > 0" ng-repeat="row in datalist.data" ng-include="\'datalistElement.html\'"></li><li class=list-group-item ng-if="datalist.errorOccured === false && datalist.loading === false && datalist.accessGranted === true && datalist.data.length === 0" ng-include="\'datalistElementEmpty.html\'"></li><li class=list-group-item ng-if="datalist.errorOccured === true" ng-include="\'datalistElementError.html\'"></li><li class="list-group-item text-center" ng-if="datalist.errorOccured === false && datalist.loading === true"><i ng-include="\'datalistElementLoadingIcon.html\'"></i> {{datalist.langPleaseWait}}</li></ul></div><div class=datalist-simple ng-if="datalist.simple === true"><li class=list-group-item ng-if="datalist.accessGranted === false && datalist.authenticated === false">{{datalist.langTextNotLogged}}</li><li class=list-group-item ng-if="datalist.accessGranted === false && datalist.authenticated === true">{{datalist.langTextNoPermission}}</li><div class=datalist-item ng-if="datalist.loading === false && datalist.accessGranted === true &&  datalist.subTemplate === undefined" ng-repeat="row in datalist.data">{{row.title}}</div><div class=datalist-item ng-if="datalist.loading === false && datalist.accessGranted === true && datalist.subTemplate !== undefined" ng-repeat="row in datalist.data" ng-include=datalist.subTemplate></div><div class=text-center ng-if="datalist.loading === true"><i ng-include="\'datalistElementLoadingIcon.html\'"></i> {{datalist.langPleaseWait}}</div></div><uib-pager ng-if="settings.pagination === true" total-items=datalist.total items-per-page=datalist.entriesPerPage previous-text={{datalist.langBtnPrevious}} next-text={{datalist.langBtnNext}} ng-model=datalist.currentPage></uib-pager></div>')}]);