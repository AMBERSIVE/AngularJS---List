!function(a,b,c){"use strict";angular.module("ambersive.list",["ui.router","ambersive.routerui.auth"]),angular.module("ambersive.list").provider("$datalistSettings",[function(){var a={langChooseAll:"Choose all",langRefresh:"Refresh",langPleaseWait:"Please wait",langBtnNext:"Next",langBtnPrevious:"Previous",langTextNoPermission:"You do not have enough permission to see this data.",langTextNotLogged:"Please login to see this data",template:"src/views/ambersive.list.default.html",entriesPerPage:10};return{setValue:function(b,d){a[b]!==c&&(a[b]=d)},$get:function(){return{all:a,template:a.template,langChooseAll:a.langChooseAll,langRefresh:a.langRefresh,langPleaseWait:a.langPleaseWait,langBtnPrevious:a.langBtnPrevious,langBtnNext:a.langBtnNext,langTextNoPermission:a.langTextNoPermission,langTextNotLogged:a.langTextNotLogged,entriesPerPage:a.entriesPerPage}}}}]),angular.module("ambersive.list").config(["$urlRouterProvider",function(a){}]),angular.module("ambersive.list").run(["$rootScope","$state","$log",function(a,b,c){}]),angular.module("ambersive.list").factory("DatalistSrv",["$q","$log","$state","$rootScope",function(a,b,d,e){var f={},g={};return f.isAuthenticated=!1,f.checkPermission=function(a){var b=!0,d=!1,e=function(){if(a.permission!==c&&a.permission.roles!==c){var e=a.permission.roles;if(angular.isArray(e)&&e.length>0&&(d=!0),angular.isArray(e)&&f.isAuthenticated===!1&&d===!0||g.roles===c&&d===!0)return!1;if(b=g.roles.some(function(a){return e.indexOf(a)>-1}),d===!0&&b===!1)return!1}return!0};return e()},e.$on("$stateAuthenticationUser",function(a,b){return g=b.user,b.user.roles!==c&&f.isAuthenticated===!1?void(f.isAuthenticated=!0):void(f.isAuthenticated=!1)}),f}]),angular.module("ambersive.list").directive("datalist",["$compile",function(a){var b={};return b.restrict="E",b.scope={template:"@",subTemplate:"@",rest:"=",api:"@",apiMethod:"@",settings:"=",simple:"@"},b.replace=!0,b.transclude=!0,b.controller=["$compile","$scope","$state","$element","$log","$timeout","$templateCache","$http","$q","$datalistSettings","DB","DatalistSrv",function(a,b,d,e,f,g,h,i,j,k,l,m){var n=this,o={};b.datalist=n,n.getTemplateByUrl=!1,n.data=[],n.result={},n.loading=!0,n.actionLoading=!1,n.selectedItems=[],n.allSelected=!1,n.actionItems=[],n.langChooseAll=k.langChooseAll,n.langRefresh=k.langRefresh,n.langPleaseWait=k.langPleaseWait,n.langBtnPrevious=k.langBtnPrevious,n.langBtnNext=k.langBtnNext,n.entriesPerPage=k.entriesPerPage,n.langTextNoPermission=k.langTextNoPermission,n.langTextNotLogged=k.langTextNotLogged,n.currentPage=0,n.authenticated=m.isAuthenticated,n.accessGranted=!0,b.template!==c?n.templateUrl=b.template:n.templateUrl=k.template,b.subTemplate!==c&&(n.subTemplate=b.subTemplate),b.settings!==c&&(o=b.settings),b.rest!==c&&(n.rest=b.rest),b.api!==c&&(n.api=b.api),b.apiMethod!==c?n.apiMethod=b.apiMethod:n.apiMethod="get",n.simple="true"===b.simple&&b.simple!==c,b.$watch("datalist.currentPage",function(){if(angular.isArray(n.result)){var a=n.entriesPerPage*n.currentPage-n.entriesPerPage,b=n.entriesPerPage,c=angular.copy(n.result);n.data=c.splice(a,b)}else angular.isObject(n.result)&&n.getData(n.currentPage)}),b.warn=function(a){f.warn(a)},n.checkActionForMultiple=function(a){if(a.multiple!==c)if(angular.isObject(a.multiple)){var b=a.multiple.show||!1;a.multiple.only||!1;if(b===!0)return a;if(b===!1&&n.selectedItems.length>0)return a}else{var d=a.multiple||!1;if(d===!0&&n.selectedItems.length>0)return a}},n.checkActionForSingle=function(a){if(m.checkPermission(a)!==!1){var b=!1;return a.multiple!==c&&angular.isObject(a.multiple)&&(b=a.multiple.only||!1),b===!1?a:void 0}},n.getMenu=function(){o.actions!==c&&(n.actions=angular.copy(o.actions).filter(n.checkActionForSingle),n.actionsMultiple=angular.copy(o.actions).filter(n.checkActionForMultiple))},n.rowDisabled=function(a){return n.actionLoading===!0&&(n.selectedItems.indexOf(a)>-1||n.actionItems.indexOf(a)>-1)?!0:!1},n.init=function(){var d=null;n.getMenu(),d=h.get(n.templateUrl),d===c&&n.templateUrl!==c&&(b.getTemplateByUrl=!0,n.getData(),i.get(n.templateUrl,{}).then(function(c){200===c.status?(d=c.data,e.html(d),e.replaceWith(a(e.html())(b))):b.warn("ambersive.list: $http loading template failed")},function(){b.warn("aambersive.list: $http loading template failed")})),b.templateHtml=d},n.getData=function(a){var d=j.defer(),e={},h=function(e){var f=e;e.data!==c&&(f=e.data),n.currentPage=a,angular.isArray(f)?(n.result=f,n.total=f.length,n.loading=!1,g(function(){b.$apply()},0)):angular.isObject(f)&&(n.total=f.length,e.total!==c&&(n.total=f.total),f.entries!==c?n.result=f.entries:n.result=f,g(function(){b.$apply()},0),n.loading=!1),d.resolve()};return a===c&&(a=1),n.accessGranted=m.checkPermission(o),n.authenticated=m.isAuthenticated,n.accessGranted===!1?void(n.loading=!1):(n.loading=!0,n.api!==c?(e=l(n.api),e[n.apiMethod]({page:a}).then(function(a){h(a),n.data=n.result,d.resolve()},function(a){n.data=[],d.reject(a)})):n.rest!==c?angular.isString(n.rest)?i.get(n.rest,{}).then(function(a){h(a.data)},function(a){f.warn("aambersive.list: $http get error (rest)"),d.resolve()}):angular.isObject(n.rest)&&i(n.rest).then(function(a){h(a.data)},function(a){f.warn("aambersive.list: $http get error (rest)"),d.resolve()}):d.resolve(),d.promise)},n.refresh=function(a){a!==c&&a.preventDefault(),n.selectedItems=[],n.selectAll=!1,n.actionLoading!==!0&&(n.getData(n.currentPage),n.getMenu())},n.callAction=function(a,b,d,f){f===c&&(f=[b.id]),d!==c&&d.preventDefault();var g,h={},i=function(a){var b=n.actionItems.indexOf(a);b>-1&&n.actionItems.splice(b,1),n.actionLoading=!1};n.actionLoading=!0,n.actionItems.push(b.id),a.apiMethod!==c?(h=l(n.api),g=function(){h[a.apiMethod](b.id,b).then(function(d,f){f===c&&(f=!0),a.successFn!==c&&angular.isFunction(a.successFn)&&a.successFn(d,e),f===!0&&n.getData(n.currentPage),i(b.id)},function(d){a.errorFn!==c&&angular.isFunction(a.errorFn)&&a.errorFn(d,e),i(b.id)})},a.preFn!==c?a.preFn(f).then(function(a){g()},function(a){}):g()):a.fn!==c&&(g=function(){a.fn(b.id,b).then(function(d){d!==c&&d.refresh===c&&(d.refresh=!0),a.successFn!==c&&angular.isFunction(a.successFn)&&a.successFn(d.result,e),d!==c&&d.refresh===!0&&n.getData(n.currentPage),i(b.id)},function(d){a.errorFn!==c&&angular.isFunction(a.errorFn)&&a.errorFn(d,e),d.refresh===c&&(d.refresh=!0),d!==c&&d.refresh===!0&&n.getData(n.currentPage),i(b.id)})},a.preFn!==c?a.preFn(f).then(function(a){g()},function(a){}):g())},n.callActionMultiple=function(a,b,d){if(d!==c&&d.preventDefault(),n.actionLoading!==!0){n.actionLoading=!0;var e,f={},g=null,h=0,i=function(a,d,e){return d===c&&(d=!1),d===!0?void(n.actionLoading=!1):(h++,void(h===b.length&&(n.actionLoading=!1,e===!0&&n.refresh())))},j=!1;a.apiMethod!==c?(f=l(n.api),g=function(b){f[a.apiMethod](b).then(function(b,c){i(b,j,a.refresh)},function(b){i(b,j,a.refresh)})},e=function(){a.multiple!==c&&a.multiple.single===!0?(j=!0,g(0)):b.forEach(function(b,c){f[a.apiMethod](b).then(function(b,c){i(b,!1,a.refresh)},function(b){i(b,!1,a.refresh)})})},a.preFn!==c?a.preFn(b).then(function(a){e()},function(a){}):e()):a.fn!==c&&(g=function(b){a.fn(b).then(function(b,c){i(b,j,a.refresh)},function(b){i(b,j,a.refresh)})},e=function(){a.multiple!==c&&a.multiple.single===!0?(j=!0,g(0)):b.forEach(function(a,b){g(a)})},a.preFn!==c?a.preFn(b).then(function(a){e()},function(a){}):e())}},n.toggleItem=function(a,b){var c=n.selectedItems.indexOf(b.id);b.isSelected===!0&&-1===c?n.selectedItems.push(b.id):n.selectedItems.splice(c,1),n.data.length===n.selectedItems.length?n.allSelected=!0:n.allSelected=!1,n.getMenu()},n.selectAll=function(a){n.selectedItems=[];var b=function(a){var b=n.selectedItems.indexOf(a.id);a.isSelected=n.allSelected,a.isSelected===!0&&-1===b?n.selectedItems.push(a.id):n.selectedItems.splice(b,1)};n.data.filter(b),n.getMenu()},n.init(),b.$on("$stateAuthenticationUser",function(a,b){n.getMenu(),n.getData()})}],b.link=function(b,d,e){try{if(b.getTemplateByUrl===!0)return;if(b.templateHtml===c)return void b.warn("ambersive.list: template is undefined");b.datalist.getData(),d.html(b.templateHtml),d.replaceWith(a(d.html())(b))}catch(f){b.warn(f)}},b}])}(window,document,void 0),angular.module("ambersive.list").run(["$templateCache",function(a){"use strict";a.put("src/views/ambersive.list.default.html",'<script type=text/ng-template id=datalistElement.html><div class="row">\n        <div class="col-xs-10">\n            <div class="checkbox" ng-if="datalist.actions.length > 0">\n                <label>\n                    <input type="checkbox" ng-model="row.isSelected" ng-click="datalist.toggleItem($event,row)" ng-disabled="datalist.rowDisabled(row.id)">\n                    <div ng-if="datalist.subTemplate === undefined">{{row.title}}</div>\n                    <div ng-if="datalist.subTemplate !== undefined" ng-include="datalist.subTemplate"></div>\n                </label>\n            </div>\n            <div ng-if="(datalist.actions.length === 0 || datalist.actions === undefined) && datalist.subTemplate === undefined">\n                {{row.title}}\n            </div>\n            <div ng-if="(datalist.actions.length === 0 || datalist.actions === undefined) && datalist.subTemplate !== undefined" ng-include="datalist.subTemplate"></div>\n        </div>\n        <div class="col-xs-2">\n            <div class="pull-right" ng-if="datalist.actions.length > 0">\n                <div class="item dropdown" uib-dropdown>\n                    <a href="#" class="btn btn-link dropdown-toggle" uib-dropdown-toggle>\n                        <i class="fa fa-chevron-down" ng-if="datalist.rowDisabled(row.id) === false || data.actionLoading === false"></i>\n                        <i ng-include="\'datalistElementLoadingIcon.html\'" ng-if="datalist.rowDisabled(row.id) === true || data.actionLoading === true"></i>\n                    </a>\n                    <ul class="dropdown-menu dropdown-menu-right">\n                        <li ng-repeat="action in datalist.actions" ng-disabled="datalist.actionLoading"><a ng-click="datalist.callAction(action,row,event)"><i ng-if="action.icon" class="{{action.icon}}"></i> {{action.label}}</a></li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div></script><script type=text/ng-template id=datalistElementLoadingIcon.html><div class="loader loader--style3" title="2">\n        <svg width="20" height="20" version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">\n          <path fill="#000" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">\n            <animateTransform attributeType="xml"\n              attributeName="transform"\n              type="rotate"\n              from="0 25 25"\n              to="360 25 25"\n              dur="0.6s"\n              repeatCount="indefinite"/>\n            </path>\n          </svg>\n    </div></script><div class=datalist_container><div class="panel panel-default" ng-if="datalist.simple === false"><div class=panel-heading><div class=row ng-if="settings.headline !== undefined || settings.description !== undefined"><div class=col-xs-12><strong ng-if=settings.headline>{{settings.headline}}</strong><p ng-if=settings.description>{{settings.description}}</p></div></div><div class=row><div class=col-xs-10><div class=checkbox ng-if="datalist.actions.length > 0"><label><input type=checkbox ng-model=datalist.allSelected ng-click=datalist.selectAll($event) ng-disabled="loading || datalist.actionLoading"> <span translate>{{datalist.langChooseAll}}</span></label></div></div><div class=col-xs-2><div class="item dropdown pull-right" uib-dropdown><i class="btn btn-link" ng-include="\'datalistElementLoadingIcon.html\'" ng-if="datalist.actionLoading === true"></i> <a href=# class="btn btn-link dropdown-toggle" ng-if="datalist.actionLoading !== true" uib-dropdown-toggle><i class="fa fa-chevron-down"></i></a><ul class="dropdown-menu dropdown-menu-right"><li ng-disabled=datalist.actionLoading><a ng-click=datalist.refresh($event) ng-disabled=datalist.actionLoading><i class="fa fa-refresh"></i> <span translate>{{datalist.langRefresh}}</span></a></li><li ng-repeat="action in datalist.actionsMultiple" ng-disabled=datalist.actionLoading><a ng-click=datalist.callActionMultiple(action,datalist.selectedItems,event) ng-disabled=datalist.actionLoading><i ng-if=action.icon class={{action.icon}}></i> {{action.label}}</a></li></ul></div></div></div></div><ul class=list-group><li class=list-group-item ng-if="datalist.accessGranted === false && datalist.authenticated === false">{{datalist.langTextNotLogged}}</li><li class=list-group-item ng-if="datalist.accessGranted === false && datalist.authenticated === true">{{datalist.langTextNoPermission}}</li><li class=list-group-item ng-if="datalist.loading === false && datalist.accessGranted === true" ng-repeat="row in datalist.data" ng-include="\'datalistElement.html\'"></li><li class="list-group-item text-center" ng-if="datalist.loading === true"><i ng-include="\'datalistElementLoadingIcon.html\'"></i> {{datalist.langPleaseWait}}</li></ul></div><div class=datalist-simple ng-if="datalist.simple === true"><li class=list-group-item ng-if="datalist.accessGranted === false && datalist.authenticated === false">{{datalist.langTextNotLogged}}</li><li class=list-group-item ng-if="datalist.accessGranted === false && datalist.authenticated === true">{{datalist.langTextNoPermission}}</li><div class=datalist-item ng-if="datalist.loading === false && datalist.accessGranted === true &&  datalist.subTemplate === undefined" ng-repeat="row in datalist.data">{{row.title}}</div><div class=datalist-item ng-if="datalist.loading === false && datalist.accessGranted === true && datalist.subTemplate !== undefined" ng-repeat="row in datalist.data" ng-include=datalist.subTemplate></div><div class=text-center ng-if="datalist.loading === true"><i ng-include="\'datalistElementLoadingIcon.html\'"></i> {{datalist.langPleaseWait}}</div></div><uib-pager total-items=datalist.total items-per-page=datalist.entriesPerPage previous-text={{datalist.langBtnPrevious}} next-text={{datalist.langBtnNext}} ng-model=datalist.currentPage></uib-pager></div>')}]);